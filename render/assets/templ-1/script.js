function menuDelegate(e){var n=$(e.target);n.is("li")&&($(this).children(".active").removeClass("active"),$("#"+$(this).data("active")).removeClass("active"),n.addClass("active"),$("#"+n.data("target")).addClass("active"),$(this).data("active",n.data("target")),setIconAndDescription(n.data("category"),n.data("icon-url"),n.data("description")))}function linkHoverDelegate(e){var n=$(e.target);n.is("a")&&setIconAndDescription(n.data("category"),n.data("icon-url"),n.data("description"))}function setIconAndDescription(e,n,t){var a=$("#link-info-"+e);n&&a.children(".icon").first().attr("src",n),a.children(".description").first().text(t)}function linkClickDelegate(e){var n=$(e.target);n.is("a")&&$.post("api/statistics?type=click&id="+n.data("id")).error(function(){})}function setBgColor(e){Modernizr.csstransitions?$("#background").css("background-color",e):$("#background").clearQueue().animate({backgroundColor:e},{duration:3e3,easing:"swing"})}function colorOpen(e){Modernizr.csstransitions||$(".bg-color").clearQueue().animate({marginLeft:"18px",marginBottom:"18px"},{duration:500,easing:"swing"})}function colorClose(e){Modernizr.csstransitions||$(".bg-color").clearQueue().animate({marginLeft:"-18px",marginBottom:"-18px"},{duration:500,easing:"swing"})}function colorDelegate(e){var n=$(e.target);if(n.is("a")){var t=n.data("color");setBgColor(t),saveBgColor(t)}}function searchInputHandle(e){13===e.keyCode&&search()}function search(){var e,n=$('input[name="engine"]:checked').val(),t=$("#search-input").val();switch(n){case"google":e="https://letsgg.tk/search?q="+encodeURIComponent(t);break;case"bing":e="https://cn.bing.com/search?q="+encodeURIComponent(t);break;case"sogou":e="https://www.sogou.com/web?query="+encodeURIComponent(t);break;case"baidu":e="https://www.baidu.com/s?wd="+encodeURIComponent(t);break;case"wikipedia":e=t?"https://w.hancel.net/w/index.php?search="+encodeURIComponent(t):"https://w.hancel.net";break;default:return}window.open(e,"_blank")}function popup(e){switch(e){case"submit":return void $("#recommend").toggle();case"feedback":return void $("#feedback").toggle()}}function closepop(){$(".popup").each(function(){$(this).css("display","none")})}function arrayToObject(e){for(var n={},t=0;t<e.length;t++){if(!e[t].value)return!1;n[e[t].name]=e[t].value}return n}function handleForm(e){return function(n){n.preventDefault(),n.stopPropagation();var t=$(this),a=t.serializeArray(),o=arrayToObject(a);return o?($.ajax({type:"POST",url:e,contentType:"application/json",data:JSON.stringify(o)}).success(function(){alert("提交成功"),t.trigger("reset")}).error(function(e){e.status<500?alert("提交失败: "+e.responseJSON&&e.responseJSON.message):alert("提交失败, 网络错误, 请稍后再试")}),!1):(alert("请将表单填写完整"),!1)}}function init(){var e=$.cookie("engine");e||(e="google",saveEngine(e)),$('input[name="engine"][value="'+e+'"]').prop("checked",!0);var n=$.cookie("bgcolor");n||(n="#b9887d",saveBgColor(n)),setBgColor(n)}function saveEngine(e){e=$(this).attr("value")||e,$.cookie("engine",e,{expires:365,path:"/"})}function saveBgColor(e){$.cookie("bgcolor",e,{expires:365,path:"/"})}$(function(){init(),$("#engines input").click(saveEngine),$(".second-classes").mouseover(menuDelegate),$(".link-page").mouseover(linkHoverDelegate),$(".link-page").click(linkClickDelegate),$("#ctrl-panel").hover(colorOpen,colorClose),$("#ctrl-panel").click(colorDelegate),$("#search-input").on("keypress",searchInputHandle),$("#search-button").click(search),$("#recommend-form").submit(handleForm("api/submits")),$("#feedback-form").submit(handleForm("api/feedbacks"))});